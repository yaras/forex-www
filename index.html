<html>
	<head>
		<title>chart</title>

		<script type="text/javascript" src="jquery-2.1.1.min.js"></script>
		<script type="text/javascript" src="knockout-3.1.0.js"></script>
		<script type="text/javascript" src="candles.js"></script>
		<script type="text/javascript" src="chartViewModel.js"></script>
		<script type="text/javascript" src="candleViewModel.js"></script>

		<script type="text/javascript">
			var chartViewModel = new ChartViewModel();

			$(function() {
				ko.applyBindings(chartViewModel);
				chartViewModel.addCandles(candles);
			});
		</script>
	</head>

	<body>
		
		<table>
			<tr>
				<td>
					<div style="border 1px solid" data-bind="{ style: { border: '1px solid black', height: height, width: width } }">
						<svg>
							<!-- ko foreach: verticalAxe -->
								<rect style="fill: #ddd" x="0" height="1" width="800" data-bind="attr: { y: y }"></rect>
								<g data-bind="attr: { transform: transform }">
									<text style="font-size: 9pt" data-bind="text: value"></text>
								</g>
							<!-- /ko -->

							<!-- ko foreach: horizontalAxe -->
								<rect style="fill: #ddd" y="0" height="500" width="1" data-bind="attr: { x: x }"></rect>
								<g data-bind="attr: { transform: transform }">
									<text style="font-size: 9pt" data-bind="text: date"></text>
								</g>
							<!-- /ko -->

							<!-- ko foreach: chartIndicators -->
								<polyline style="fill:none; stroke: red; stroke-width:1" data-bind="attr: {points: points}"></polyline>
							<!-- /ko -->

							<!-- ko foreach: candles -->					
								<g data-bind="event: { mouseover: setSelected, mouseout: setUnselected }">
									<rect style="fill: none" data-bind="attr: { style: candleStyle, x: shadowX() - 4, height: shadowHeight, width: 10, y: shadowY }"></rect>

									<rect style="fill: black" width="1" data-bind="{attr: { x: shadowX, y: shadowY, height: shadowHeight }}"></rect>

									<rect data-bind="{attr: { style: bodyStyle, x: bodyX, y: bodyY, height: bodyHeight, width: 6 }}"></rect>
								</g>
							<!-- /ko -->
						</svg>
					</div>	
				</td>

				<td>
					<div data-bind="if: selected">
						date: <span data-bind="text: selected().date"></span>
						<br />
						open: <span data-bind="text: selected().open"></span>
						<br />
						high: <span data-bind="text: selected().high"></span>
						<br />
						low: <span data-bind="text: selected().low"></span>
						<br />
						close: <span data-bind="text: selected().close"></span>
					</div>
				</td>
			</tr>
	</body>
</html>